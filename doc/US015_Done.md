# US-015: タグ別フィルタリング 完了報告

## 完了定義

- タグによるタスクのフィルタリング機能が実装され、以下の受け入れ条件を満たしていること。
  - 単一タグで絞り込める
  - 複数タグでのAND検索が可能
  - 存在するタグの一覧が表示される
- 関連する単体テストが作成され、パスしていること。

## 完了のエビデンス

### 1. タグフィルタリングロジックの実装

`internal/app/app.go` に `GetFilteredTasksByTags` メソッドを実装し、指定されたタグでタスクをフィルタリングするロジックを追加しました。複数のタグが指定された場合は、それら全てのタグを持つタスクを返すAND検索として機能します。

また、`GetAllUniqueTags` メソッドを追加し、全てのタスクからユニークなタグのリストを取得できるようにしました。

### 2. タグ選択UIの実装

`cmd/main.go` の `model` 構造体に `filterTagsInput` と `filteredTags` フィールドを追加しました。
`initialModel` 関数で `filterTagsInput` を初期化し、`Update` メソッドで `t` キーによるタグフィルタリングモードへの遷移と、`enter` キーによるフィルタリング適用ロジックを実装しました。
`esc` キーでフィルタリングを解除する際に、タグフィルタリング関連のフィールドもクリアするようにしました。

### 3. タグ一覧表示機能

`cmd/main.go` の `View` メソッドの `filter_tags` ケースにおいて、`m.app.GetAllUniqueTags()` を使用して存在するタグの一覧を表示するように実装しました。

### 4. 複数タグ検索の実装

`GetFilteredTasksByTags` メソッド内で、複数のタグが指定された場合に全てのタグを持つタスクを返すAND検索ロジックを実装しました。

### 5. 単体テストの作成

`internal/app/app_test.go` に以下のテストケースを追加し、タグフィルタリング機能とユニークタグ取得機能が正しく動作することを確認しました。

- `TestGetFilteredTasksByTags`: タグによるフィルタリングのテスト
- `TestGetAllUniqueTags`: ユニークなタグの取得テスト

これらの変更により、US-015のすべての要件が満たされました。